{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="glass-panel p-5 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="text-white mb-0">{{ asset.name }}</h2>
                <div>
                    {% if user.is_staff %}
                        <a href="{% url 'app_assets:asset_update' asset.id %}" class="btn btn-warning btn-sm me-2">Edit</a>
                        <a href="{% url 'app_assets:asset_delete' asset.id %}" class="btn btn-danger btn-sm">Delete</a>
                    {% endif %}
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <p class="text-white-50 mb-1">Status</p>
                     {% if asset.is_monitored %}
                        <span class="badge bg-info text-dark">Monitored</span>
                    {% else %}
                        <span class="badge bg-secondary">Unmonitored</span>
                    {% endif %}
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-white-50 mb-1">IP Address</p>
                    <span class="text-white fw-bold">{{ asset.ip_address|default:"N/A" }}</span>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <p class="text-white-50 mb-1">Category</p>
                    <span class="text-white">{{ asset.category.name|default:"-" }}</span>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-white-50 mb-1">Location</p>
                    <span class="text-white">{{ asset.location.name|default:"-" }}</span>
                </div>
            </div>

            <div class="mb-4">
                <p class="text-white-50 mb-1">Assigned To: <span class="text-white">{{ asset.assigned_to|default:"Unassigned" }}</span></p>
                <p class="text-white-50 mb-1">Alert Email: <span class="text-white">{{ asset.alert_email|default:"-" }}</span></p>
            </div>

            <hr class="border-light opacity-25">

            <div class="row mb-4">
                 <div class="col-md-4">
                    <p class="text-white-50 mb-1">Make</p>
                    <span class="text-white">{{ asset.make|default:"-" }}</span>
                </div>
                <div class="col-md-4">
                    <p class="text-white-50 mb-1">Model No.</p>
                    <span class="text-white">{{ asset.model_no|default:"-" }}</span>
                </div>
                <div class="col-md-4">
                    <p class="text-white-50 mb-1">Serial Number</p>
                    <span class="text-white">{{ asset.serial_number|default:"-" }}</span>
                </div>
            </div>

            {% if asset.specifications %}
            <h4 class="text-white mb-3">Specifications</h4>
            <div class="table-responsive mb-4">
                <table class="table table-sm table-borderless text-white">
                    <tbody>
                        {% for key, value in asset.specifications.items %}
                        <tr>
                            <td class="text-white-50 w-25">{{ key }}</td>
                            <td>{{ value }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% endif %}

            {% if asset.notes %}
            <h4 class="text-white mb-3">Notes</h4>
            <p class="text-white-50">{{ asset.notes|linebreaks }}</p>
            {% endif %}
        </div>
    </div>

    <div class="col-md-4">
        <!-- Sidebar: Could show Ping History or Monitoring Status Detail -->
        <div class="glass-panel p-4 mb-4">
            <h5 class="text-white mb-3">Monitoring Status</h5>
            {% if asset.is_monitored %}
                <div class="mb-3">
                    <span class="d-block text-white-50 mb-1">Current Status:</span>
                    {% if asset.current_status %}
                        <span class="badge bg-success fs-6">ONLINE</span>
                    {% else %}
                        <span class="badge bg-danger fs-6">OFFLINE</span>
                    {% endif %}
                </div>

                <p class="text-white-50">Last Latency:
                    <span class="text-white fw-bold">
                        {% if asset.latest_latency %}
                            {{ asset.latest_latency|floatform:2 }} ms
                        {% else %}
                            N/A
                        {% endif %}
                    </span>
                </p>
            {% else %}
                <p class="text-white-50">Monitoring is disabled for this asset.</p>
            {% endif %}
        </div>

        <a href="{% url 'app_assets:asset_list' %}" class="btn btn-outline-light w-100">
            <i class="bi bi-arrow-left"></i> Back to Assets
        </a>
    </div>
</div>
{% endblock %}
